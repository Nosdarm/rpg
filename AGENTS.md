## –ù–æ–≤–∞—è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ê–≥–µ–Ω—Ç–∞ (–æ—Ç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã:**

1.  **–ê–Ω–∞–ª–∏–∑ `AGENTS.md`:** –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –ª—é–±–æ–π —Ä–∞–±–æ—Ç—ã –≤—Å–µ–≥–¥–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª (`AGENTS.md`).
2.  **–†–∞–±–æ—Ç–∞ —Å –∑–∞–¥–∞—á–∞–º–∏ –∏–∑ `Tasks.txt`:**
    *   –ë—Ä–∞—Ç—å –æ–¥–Ω—É –∑–∞–¥–∞—á—É –∑–∞ —Ä–∞–∑ –∏–∑ —Ñ–∞–π–ª–∞ `Tasks.txt`.
    *   –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –∫–∞–∂–¥—É—é –≤–∑—è—Ç—É—é –∑–∞–¥–∞—á—É. –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞, —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤, –∏, –µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ, –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤.
3.  **–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –≤ `AGENTS.md`:**
    *   `AGENTS.md` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å.
    *   –ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ, –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç–æ–µ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á–∏, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–ø–∏—Å–∞–Ω–æ –≤ `AGENTS.md`. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å, –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –ø—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è.
4.  **–û—Ç–º–µ—Ç–∫–∞ –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤ `Done.txt`:**
    *   –ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∏ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á–∏, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ–µ –Ω–æ–º–µ—Ä –∏ –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ) –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª `Done.txt`.
5.  **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**
    *   –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω. –≠—Ç–æ—Ç –ø–ª–∞–Ω —Ç–∞–∫–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç—Ä–∞–∂–µ–Ω –≤ `AGENTS.md` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–µ–∫—Ü–∏–∏ "–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω").
6.  **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π:**
    *   –Ø–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ —Ö–æ–¥–µ —Ç–µ–∫—É—â–µ–≥–æ –¥–∏–∞–ª–æ–≥–∞, –∏–º–µ—é—Ç –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç.
    *   –ó–∞—Ç–µ–º —Å–ª–µ–¥—É—é—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ —ç—Ç–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ ("–ù–æ–≤–∞—è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ê–≥–µ–Ω—Ç–∞").
    *   –ó–∞—Ç–µ–º —Å–ª–µ–¥—É—é—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –≤ `AGENTS.md` (–µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∞—Ç –±–æ–ª–µ–µ –Ω–æ–≤—ã–º).

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ `AGENTS.md` (–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è):**

*   **–ù–æ–≤–∞—è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ê–≥–µ–Ω—Ç–∞ (–æ—Ç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è):** (–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª)
*   **–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω:** –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è —Ç–µ–∫—É—â–µ–π –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞–¥–∞—á–∏.
*   **–õ–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π:** –•—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∑–∞–¥–∞—á–∏.
*   **(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π:** –ú–æ–≥—É—Ç –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏, –Ω–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏.

---

## –û–±—â–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ê–≥–µ–Ω—Ç–∞ (–û–±–Ω–æ–≤–ª–µ–Ω–æ) - *–≠—Ç–∞ —Å–µ–∫—Ü–∏—è —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π*

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã:**

1.  **–ê–Ω–∞–ª–∏–∑ `AGENTS.md`:** –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã –≤—Å–µ–≥–¥–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª.
2.  **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á:** –ó–∞–¥–∞—á–∏ –±–µ—Ä—É—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ `Tasks.txt` —Å—Ç—Ä–æ–≥–æ –ø–æ –æ–¥–Ω–æ–π.
3.  **–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –ö–∞–∂–¥–∞—è –≤–∑—è—Ç–∞—è –∑–∞–¥–∞—á–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, –≤–∫–ª—é—á–∞—è –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞, —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏, –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, —Ç–µ—Å—Ç–æ–≤.
4.  **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `AGENTS.md`:** –ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ, –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç–æ–µ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á–∏, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–ø–∏—Å–∞–Ω–æ –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ (`AGENTS.md`) –≤ —Å–µ–∫—Ü–∏–∏ "–õ–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π". –≠—Ç–æ—Ç —Ñ–∞–π–ª —è–≤–ª—è–µ—Ç—Å—è –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç—å—é –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –ø—Ä–∏–Ω—è—Ç—ã—Ö —Ä–µ—à–µ–Ω–∏–π.
5.  **–û—Ç–º–µ—Ç–∫–∞ –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤ `Done.txt`:** –ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∏ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ–µ –Ω–æ–º–µ—Ä –∏ –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ) –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª `Done.txt`.
6.  **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `Tasks.txt` (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ):** –ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–æ –æ–±—â–∏–º —Ä–∞–±–æ—á–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–¥–∞—á–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è), —Ç–æ –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ –≤ `Done.txt`, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –∑–∞–¥–∞—á–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–ª–∏ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –≤ `Tasks.txt`. *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ò—Å—Ö–æ–¥–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∫–∞–∑—ã–≤–∞–ª–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ, —Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è `AGENTS.md` —Ç–∞–∫–∂–µ —ç—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç. –ë—É–¥–µ–º —Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–æ–º—É.*
7.  **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π:** –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–µ–π, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –≠—Ç–æ—Ç –ø–ª–∞–Ω –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å–µ–∫—Ü–∏—é "–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω" –≤ `AGENTS.md`.
8.  **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π:** –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ —Ö–æ–¥–µ –¥–∏–∞–ª–æ–≥–∞, –∏–º–µ—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ –æ–±—â–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –≤ `AGENTS.md`.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ `AGENTS.md`:**

*   **–û–±—â–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ê–≥–µ–Ω—Ç–∞:** (–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª)
*   **–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω:** –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è —Ç–µ–∫—É—â–µ–π –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞–¥–∞—á–∏.
*   **–õ–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π:** –•—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ —Å–µ—Å—Å–∏–∏.

---

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∞–≥–µ–Ω—Ç–∞ (–ò—Å—Ö–æ–¥–Ω–∞—è - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏, —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–≤–∞—Ç—å—Å—è "–ù–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π" –≤—ã—à–µ)

1.  **–û–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏–µ —Å –∑–∞–¥–∞—á–∞–º–∏:** –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª `Tasks.txt` –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤—Å–µ–≥–æ –æ–±—ä–µ–º–∞ —Ä–∞–±–æ—Ç.
2.  **–í—ã–±–æ—Ä –∑–∞–¥–∞—á–∏:** –í–∑—è—Ç—å –æ–¥–Ω—É –∑–∞–¥–∞—á—É –∏–∑ —Ñ–∞–π–ª–∞ `Tasks.txt` –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
3.  **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**
    *   –°–æ–∑–¥–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏.
    *   –ó–∞–ø–∏—Å–∞—Ç—å –ø–ª–∞–Ω –≤ `AGENTS.md` –≤ —Å–µ–∫—Ü–∏—é "–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω".
4.  **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    *   –ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏.
    *   –°–æ–∑–¥–∞—Ç—å –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã.
    *   –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ).
5.  **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π:**
    *   –ö–∞–∂–¥–æ–µ –∑–Ω–∞—á–∏–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (—Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏ —Ç.–¥.) –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø–∏—Å–∞–Ω–æ –≤ `AGENTS.md` –≤ —Å–µ–∫—Ü–∏—é "–õ–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π".
6.  **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏:**
    *   –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∑–∞–ø–∏—Å–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É –≤ —Ñ–∞–π–ª `done.txt`.
    *   –£–¥–∞–ª–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É –∏–∑ —Ñ–∞–π–ª–∞ `Tasks.txt`.
7.  **–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ:** –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —à–∞–≥—É 2, –µ—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ `Tasks.txt` –æ—Å—Ç–∞–ª–∏—Å—å –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏.
8.  **–û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –∫–æ–º–º–∏—Ç–æ–º.

## –õ–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π

- **–ó–∞–¥–∞—á–∞ 19: üìö 7.3 Turn and Report Formatting (Guild-Scoped)**:
    - **–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π**: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ API `format_log_entry` –∏ `format_turn_report`, –≤–∫–ª—é—á–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `StoryLog.details_json`, i18n –∏–º–µ–Ω —Å—É—â–Ω–æ—Å—Ç–µ–π, `RuleConfig` –∏ —Ü–µ–ª–µ–≤–æ–≥–æ —è–∑—ã–∫–∞.
    - **–°–æ–∑–¥–∞–Ω–∏–µ `src/core/report_formatter.py`**: –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –¥–ª—è `format_log_entry` –∏ `format_turn_report`, –≤–∫–ª—é—á–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä `AsyncSession`.
    - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è `get_localized_entity_name`**:
        - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/core/localization_utils.py`.
        - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `get_localized_entity_name(session, guild_id, entity_type, entity_id, language, fallback_language)` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏–º–µ–Ω —Å—É—â–Ω–æ—Å—Ç–µ–π.
        - –í–∫–ª—é—á–∞–µ—Ç `ENTITY_TYPE_MODEL_MAP` –∏ `ENTITY_TYPE_GETTER_MAP` –¥–ª—è —Ä–µ–∑–æ–ª—é—Ü–∏–∏ —Ç–∏–ø–æ–≤ —Å—É—â–Ω–æ—Å—Ç–µ–π (—Ç–µ–∫—É—â–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞: "player", "location", "npc", "item", —Å placeholder-–≥–µ—Ç—Ç–µ—Ä–∞–º–∏ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö).
        - –í–∫–ª—é—á–∞–µ—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `get_localized_text` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–ª–µ–π `name_i18n`.
    - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è `format_log_entry`**:
        - –í `src/core/report_formatter.py` –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `format_log_entry`.
        - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤—ã–∑–æ–≤ `get_localized_entity_name` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–º–µ–Ω —Å—É—â–Ω–æ—Å—Ç–µ–π.
        - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π: `PLAYER_ACTION` (—Å –ø–æ–¥—Ç–∏–ø–∞–º–∏ `examine`, `interact`, `go_to`), `PLAYER_MOVE`, `ITEM_ACQUIRED`, `COMBAT_ACTION`.
        - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –±–∞–∑–æ–≤—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —à–∞–±–ª–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤ (en/ru).
    - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è `format_turn_report`**:
        - –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –±–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `format_turn_report` –≤ `src/core/report_formatter.py`. –û–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Ç–µ—Ä–∏—Ä—É–µ—Ç –ø–æ –ª–æ–≥–∞–º, –≤—ã–∑—ã–≤–∞–µ—Ç `format_log_entry`, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—É—Å—Ç—ã–µ –ª–æ–≥–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏.
    - **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `src/core/__init__.py`**:
        - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã –¥–ª—è `localization_utils` (`get_localized_entity_name`, `get_localized_text`) –∏ `report_formatter` (`format_log_entry`, `format_turn_report`).
        - –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `__all__`.
        - –û–±–Ω–æ–≤–ª–µ–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ª–æ–≥–≥–µ—Ä–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–∞ `core`.
    - **–ù–∞–ø–∏—Å–∞–Ω–∏–µ Unit-—Ç–µ—Å—Ç–æ–≤**:
        - –°–æ–∑–¥–∞–Ω `tests/core/test_localization_utils.py` —Å —Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è `get_localized_text` –∏ `get_localized_entity_name` (–ø–æ–∫—Ä—ã—Ç–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –≤–∫–ª—é—á–∞—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏, —è–∑—ã–∫–æ–≤—ã–µ —Ñ–æ–ª–±–µ–∫–∏, –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã).
        - –°–æ–∑–¥–∞–Ω `tests/core/test_report_formatter.py` —Å —Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è `format_log_entry` (–¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π –∏ —è–∑—ã–∫–æ–≤) –∏ `format_turn_report` (–∞–≥—Ä–µ–≥–∞—Ü–∏—è, –ø—É—Å—Ç—ã–µ –ª–æ–≥–∏, –æ–±—Ä–∞–±–æ—Ç–∫–∞ `guild_id`).
        - –¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–æ–∫–∏ –¥–ª—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `get_localized_entity_name` –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ `format_log_entry`).
- **–ó–∞–¥–∞—á–∞ 18: üìö 7.2 AI Narrative Generation (Multilang)**:
    - **–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π**: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ API `generate_narrative`, –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –¥–ª—è –ø—Ä–æ–º–ø—Ç–∞, –æ–±—Ä–∞–±–æ—Ç–∫–µ —è–∑—ã–∫–∞ (—è–∑—ã–∫ –∏–≥—Ä–æ–∫–∞/–≥–∏–ª—å–¥–∏–∏).
    - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è `generate_narrative`**:
        - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `generate_narrative(session, guild_id, context)` –≤ `src/core/ai_orchestrator.py`.
        - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ —è–∑—ã–∫–∞ (—Å–Ω–∞—á–∞–ª–∞ —è–∑—ã–∫ –∏–≥—Ä–æ–∫–∞ –∏–∑ `Player.selected_language` —á–µ—Ä–µ–∑ `context['player_id']`, –∑–∞—Ç–µ–º —è–∑—ã–∫ –≥–∏–ª—å–¥–∏–∏ –∏–∑ `RuleConfig` –∫–ª—é—á–∞ `guild_main_language`, –∑–∞—Ç–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π 'en').
        - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ `context` (event_type, involved_entities, location_data, world_state_summary, custom_instruction).
        - –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –º–æ–∫-—Ñ—É–Ω–∫—Ü–∏—è `_mock_narrative_openai_api_call(prompt, language)` –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞ LLM —Å —É—á–µ—Ç–æ–º —è–∑—ã–∫–∞.
        - –§—É–Ω–∫—Ü–∏—è `generate_narrative` –≤—ã–∑—ã–≤–∞–µ—Ç `_mock_narrative_openai_api_call`.
        - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ LLM.
        - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã `get_player` –∏ `get_rule` –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥—É–ª—è.
    - **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `src/core/__init__.py`**:
        - `generate_narrative` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –∏–º–ø–æ—Ä—Ç—ã –∏–∑ `src.core.ai_orchestrator`.
        - `generate_narrative` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `__all__`.
    - **–ù–∞–ø–∏—Å–∞–Ω–∏–µ Unit-—Ç–µ—Å—Ç–æ–≤**:
        - –í `tests/core/test_ai_orchestrator.py` –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è `generate_narrative`.
        - –¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `@patch` –¥–ª—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è `_mock_narrative_openai_api_call`, `get_player`, `get_rule` –∏ `@transactional`.
        - –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤:
            - –£—Å–ø–µ—à–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —è–∑—ã–∫–∞ –∏–≥—Ä–æ–∫–∞.
            - –£—Å–ø–µ—à–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —è–∑—ã–∫–∞ –≥–∏–ª—å–¥–∏–∏ (–∫–æ–≥–¥–∞ —É –∏–≥—Ä–æ–∫–∞ –Ω–µ—Ç —è–∑—ã–∫–∞ –∏–ª–∏ –Ω–µ—Ç `player_id` –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ).
            - –£—Å–ø–µ—à–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —è–∑—ã–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ('en'), –∫–æ–≥–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —è–∑—ã–∫–∞ –∏–≥—Ä–æ–∫–∞/–≥–∏–ª—å–¥–∏–∏.
            - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ —Å–æ –≤—Å–µ–º–∏ –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
            - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ LLM (–≤–æ–∑–≤—Ä–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —è–∑—ã–∫–µ).
        - –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –º–æ–∫ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ `@transactional` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ —Å–µ—Å—Å–∏–∏ –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö.
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ —Ç–µ—Å—Ç–∞—Ö (–°–µ—Å—Å–∏—è [—Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è])**
    - **–ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è:** –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ `python -m pytest` –≤—ã—è–≤–∏–ª –æ—à–∏–±–∫–∏ `fixture 'mocker' not found` –≤ `tests/core/test_action_processor.py` –∏ `AttributeError: ... has no attribute 'get_db_session'` –≤–º–µ—Å—Ç–µ —Å `ModuleNotFoundError: No module named 'core'` –≤ `tests/bot/test_general_commands_mocked.py`. –¢–∞–∫–∂–µ –±—ã–ª–∞ –æ—à–∏–±–∫–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ `test_ping_command`.
    - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ `tests/core/test_action_processor.py`**:
        - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `pytest-mock` –≤ `requirements.txt` –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ (`pip install -r requirements.txt`). –≠—Ç–æ —É—Å—Ç—Ä–∞–Ω–∏–ª–æ –æ—à–∏–±–∫—É `fixture 'mocker' not found`.
        - –í—ã—è–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å —Ç–µ–º, —á—Ç–æ `ACTION_DISPATCHER` –≤ `src/core/action_processor.py` –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–ª —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ –∏—Ö –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è.
        - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ–∏–∫—Å—Ç—É—Ä–∞ `patch_action_handlers_directly`: —Ç–µ–ø–µ—Ä—å –æ–Ω–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –º–æ–∫–∏—Ä—É–µ—Ç –∏–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π –≤ –º–æ–¥—É–ª–µ `src.core.action_processor`, –Ω–æ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ —ç—Ç–∏ –º–æ–∫–∏ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Å–ª–æ–≤–∞—Ä–µ `src.core.action_processor.ACTION_DISPATCHER`. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–ª–æ –≤—ã–∑–æ–≤ –∑–∞–º–æ–∫–∞–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏–π.
        - –£–¥–∞–ª–µ–Ω –ª–∏—à–Ω–∏–π –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@transactional` —Å —Ñ—É–Ω–∫—Ü–∏–∏ `_load_and_clear_actions` –≤ `src/core/action_processor.py`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —É–∂–µ –≤ —Ä–∞–º–∫–∞—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
        - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è DEBUG –≤ `_load_and_clear_actions` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–µ–π—Å—Ç–≤–∏–π –∏–≥—Ä–æ–∫–∞.
        - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–∏–∫—Å—Ç—É—Ä–∞ `configure_module_logging` –≤ `tests/core/test_action_processor.py` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è DEBUG –ª–æ–≥–æ–≤ –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–æ–≤.
        - –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—Å–µ —Ç–µ—Å—Ç—ã –≤ `tests/core/test_action_processor.py` –ø—Ä–æ—Ö–æ–¥—è—Ç.
    - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ `tests/bot/test_general_commands_mocked.py`**:
        - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `AttributeError: module 'src.bot.general_commands' has no attribute 'author'`:
            - –¢–µ—Å—Ç—ã –¥–ª—è –∫–æ–º–∞–Ω–¥—ã `start_command` –±—ã–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ–∏–∫—Å—Ç—É—Ä—ã `mock_ctx` (–∫–æ—Ç–æ—Ä–∞—è –º–æ–∫–∞–µ—Ç `commands.Context`) –≤–º–µ—Å—Ç–æ `mock_interaction`.
            - –ê—Ç—Ä–∏–±—É—Ç—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (`guild.id`, `author.id`, `author.display_name`, `send`) —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `mock_ctx`.
            - –§–∏–∫—Å—Ç—É—Ä–∞ `mock_ctx` –±—ã–ª–∞ —É—Ç–æ—á–Ω–µ–Ω–∞: `ctx.author` —Ç–µ–ø–µ—Ä—å `MagicMock()` –±–µ–∑ `spec` –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (`display_name`, `mention`). `ctx.bot` —Ç–∞–∫–∂–µ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `MagicMock()` –±–µ–∑ `spec` –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–∏–∫—Å—Ç—É—Ä—É `mock_bot` –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ `bot.latency`.
        - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `ModuleNotFoundError: No module named 'core'` –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ `start_command`:
            - –ò–º–ø–æ—Ä—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `start_command` –≤ `src/bot/general_commands.py` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `from core.database...`) –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã –Ω–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –æ—Ç –∫–æ—Ä–Ω—è `src` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `from src.core.database...`). –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–æ–≤.
        - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏ –¥–ª—è `patch` CRUD –æ–ø–µ—Ä–∞—Ü–∏–π (`player_crud`, `location_crud`) –≤ —Ç–µ—Å—Ç–∞—Ö `start_command`. –¢–µ–ø–µ—Ä—å –æ–Ω–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –º–µ—Å—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç—Ç–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `'src.core.crud.crud_player.player_crud.get_by_discord_id'`), —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ `start_command`.
        - –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `PlayerStatus` –∏–∑ `src.models.enums` –≤ `tests/bot/test_general_commands_mocked.py`.
        - –í `test_start_command_new_player` —É—Ç–æ—á–Ω–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ `created_player_instance_mock` –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ (`FixedPlayerNameInTest`). –£ –º–æ–∫–∞ `mock_location` –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `name_i18n`.
        - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ `test_ping_command`: –∞—Å—Å–µ—Ä—à–Ω —Ç–µ–ø–µ—Ä—å –æ–∂–∏–¥–∞–µ—Ç `"–ü–æ–Ω–≥!"` –∏ `"123ms"` (–±–µ–∑ –ø—Ä–æ–±–µ–ª–∞).
        - –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—Å–µ —Ç–µ—Å—Ç—ã –≤ `tests/bot/test_general_commands_mocked.py` –ø—Ä–æ—Ö–æ–¥—è—Ç.
    - **–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ 135 —Ç–µ—Å—Ç–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω—ã.
    - **–û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (RuntimeWarning)**:
        - –í `tests/core/test_turn_controller.py` –∏ `tests/test_main.py` –æ—Å—Ç–∞–ª–∏—Å—å `RuntimeWarning` —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å `AsyncMockMixin._execute_mock_call` –∏ –Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ `asyncio`. –≠—Ç–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç –ø–∞–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –∏ —Ç—Ä–µ–±—É—é—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ, –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–≥–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –µ—Å–ª–∏ –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –∏—Ö —É—Å—Ç—Ä–∞–Ω–∏—Ç—å.
- **–ó–∞–¥–∞—á–∞ ‚öôÔ∏è 6.1.1 Intra-Location Interaction Handler Module**:
    - **–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π**: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–µ–π—Å—Ç–≤–∏–π –≤–Ω—É—Ç—Ä–∏ –ª–æ–∫–∞—Ü–∏–∏ (`examine`, `interact`, `move_to_sublocation`), API `handle_intra_location_action`.
    - **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ Player**: –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `current_sublocation_name: Optional[str]` –≤ –º–æ–¥–µ–ª—å `Player` (`src/models/player.py`) –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–ª–æ–∂–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ –≤–Ω—É—Ç—Ä–∏ —Ç–µ–∫—É—â–µ–π –ª–æ–∫–∞—Ü–∏–∏.
    - **–ú–∏–≥—Ä–∞—Ü–∏—è Alembic**: –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `0008_add_player_sublocation.py` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è –≤ –ë–î. `down_revision` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `4a069d44a15c` —Å–æ–≥–ª–∞—Å–Ω–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π.
    - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è `interaction_handlers.py`**:
        - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/core/interaction_handlers.py`.
        - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `handle_intra_location_action(guild_id, session, player_id, action_data)`:
            - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–≥—Ä–æ–∫–∞ –∏ –µ–≥–æ —Ç–µ–∫—É—â—É—é –ª–æ–∫–∞—Ü–∏—é.
            - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `_find_target_in_location` –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤/—Å—É–±–ª–æ–∫–∞—Ü–∏–π –≤ `Location.generated_details_json.interactable_elements` (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞: —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å `name`, `description_i18n`, `type`, `interaction_rules_key`, `actual_sublocation_name` –∏ —Ç.–¥.).
            - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ–Ω—Ç `examine`: –∏–∑–≤–ª–µ–∫–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ —Ü–µ–ª–∏ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å.
            - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ–Ω—Ç `interact`: MVP-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞–º–∏ –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ `RuleConfig` –∏ `resolve_check`. –õ–æ–≥–∏—Ä—É–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.
            - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ–Ω—Ç `move_to_sublocation`: –æ–±–Ω–æ–≤–ª—è–µ—Ç `player.current_sublocation_name` (–∏—Å–ø–æ–ª—å–∑—É—è `actual_sublocation_name` –∏–∑ –¥–∞–Ω–Ω—ã—Ö —Ü–µ–ª–∏, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ).
            - –í—ã–∑—ã–≤–∞–µ—Ç –∑–∞–≥–ª—É—à–∫—É `log_event` –¥–ª—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π.
            - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        - –ú–æ–¥—É–ª—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ `src/core/__init__.py`.
    - **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `action_processor.py`**:
        - –í `src/core/action_processor.py` –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω `handle_intra_location_action`.
        - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±–µ—Ä—Ç–æ—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `_handle_intra_location_action_wrapper`.
        - –û–±–Ω–æ–≤–ª–µ–Ω `ACTION_DISPATCHER` –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ–Ω—Ç–æ–≤ `examine`, `interact`, `go_to` (–¥–ª—è —Å—É–±–ª–æ–∫–∞—Ü–∏–π) –Ω–∞ –Ω–æ–≤—É—é –æ–±–µ—Ä—Ç–æ—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é.
    - **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ NLU (`nlu_service.py`)**:
        - –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è "examine <target>" –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–Ω—Ç–µ–Ω—Ç–∞ `examine` –∏ —Å—É—â–Ω–æ—Å—Ç–∏ `name`.
        - –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ regex-–ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –∏–Ω—Ç–µ–Ω—Ç–æ–≤ `interact` (—Å —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏ `use`, `activate` –∏ —Ç.–¥.) –∏ `go_to` (–¥–ª—è —Å—É–±–ª–æ–∫–∞—Ü–∏–π, —Å —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏ `enter`, `move to`), —Ç–∞–∫–∂–µ –∏–∑–≤–ª–µ–∫–∞—é—â–∏–µ —Å—É—â–Ω–æ—Å—Ç—å `name`.
    - **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ–µ/–º–∞–Ω—É–∞–ª—å–Ω–æ–µ)**:
        - –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ –∏—Å—Ö–æ–¥–æ–≤.
        - –í —Ö–æ–¥–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã—è–≤–ª–µ–Ω–∞ –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –∫–∞–Ω–æ–Ω–∏—á–Ω–æ–µ –∏–º—è –¥–ª—è —Å—É–±–ª–æ–∫–∞—Ü–∏–∏ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ `player.current_sublocation_name` (—á–µ—Ä–µ–∑ –ø–æ–ª–µ `actual_sublocation_name` –≤ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞).
    - **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –û–±–Ω–æ–≤–ª–µ–Ω "–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω" –∏ "–õ–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π" –≤ `AGENTS.md`.
- **Task 17: üìö 7.1 Event Log Model (Story Log, i18n, Guild-Scoped)**:
    - **Analysis**: Reviewed requirements for `StoryLog` model and `log_event` API from `Tasks.txt`.
        - Model fields: `id`, `guild_id`, `timestamp`, `location_id`, `event_type`, `entity_ids_json`, `details_json`.
        - API: `log_event(session, guild_id, event_type, details_json, player_id, party_id, location_id, entity_ids_json)`.
        - Decided to use existing `EventType` ENUM from `src/models/enums.py` as found in pre-existing `story_log.py`.
    - **Model Definition**:
        - Found existing `src/models/story_log.py` which largely matched requirements, including `EventType` enum usage and an additional `narrative_i18n` field.
        - Updated `src/models/story_log.py` to correctly define relationships:
            - `guild: Mapped["GuildConfig"] = relationship(back_populates="story_logs")`
            - `location: Mapped[Optional["Location"]] = relationship()`
        - Updated `src/models/guild.py` by adding the corresponding `story_logs: Mapped[List["StoryLog"]] = relationship(back_populates="guild", cascade="all, delete-orphan")` relationship and type hints.
        - Verified `StoryLog` and `EventType` were already imported in `src/models/__init__.py`.
    - **Alembic Migration**:
        - Identified latest migration as `0008_add_player_sublocation`.
        - Installed dependencies from `requirements.txt` using `pip install -r requirements.txt` to make `alembic` command available.
        - Generated new migration `alembic revision -m "create_story_logs_table" --rev-id "0009"`.
        - Edited `alembic/versions/0009_create_story_logs_table.py`:
            - Set `down_revision = '0008_add_player_sublocation'`.
            - Added operations to create and drop the `event_type_enum` PostgreSQL ENUM type (named `event_type_enum` to match model).
            - Added operations to create and drop the `story_logs` table, matching the `StoryLog` model fields, FKs, and indexes.
            - Corrected `details_json` column to be `nullable=True` to match the model definition.
    - **API Implementation**:
        - Implemented `log_event` function in `src/core/game_events.py`, replacing the existing placeholder.
        - Ensured `AsyncSession` type hint and import.
        - Added logic to convert input `event_type` string (e.g., "PLAYER_ACTION") to `EventType` enum member.
        - Added logic to automatically populate `entity_ids_json` with `player_id` (under 'players' key) and `party_id` (under 'parties' key) if provided.
        - Updated `src/core/__init__.py` to import `log_event` and `on_enter_location` from `game_events` and add them to `__all__`.
    - **Unit Tests**:
        - Created `tests/core/test_game_events.py`.
        - Wrote tests for `log_event`: successful logging, invalid event type, entity_ids handling, and minimal parameters.
        - Resolved `ModuleNotFoundError: No module named 'src'` during test runs by using `python -m pytest`.
        - Corrected tests to handle `StoryLog.timestamp` (which uses `server_default`) being `None` in unit tests as the database is not hit.
        - All 10 tests for `log_event` passed.
- **–í–∞–∂–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ –º–∏–≥—Ä–∞—Ü–∏—è—Ö Alembic (–°–µ—Å—Å–∏—è [—Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è]):**
    - –ü–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (0002-0007), —É–ø–æ–º—è–Ω—É—Ç—ã–µ –≤ –ª–æ–≥–∞—Ö, –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã.
    - –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Ç–µ–ø–µ—Ä—å `4a069d44a15c_initial_schema.py`.
    - –í—Å–µ –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –±—É–¥—É—Ç –æ—Å–Ω–æ–≤—ã–≤–∞—Ç—å—Å—è –Ω–∞ `4a069d44a15c` –≤ –∫–∞—á–µ—Å—Ç–≤–µ `down_revision`. –õ–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞ –¥–æ —ç—Ç–æ–π –æ—Ç–º–µ—Ç–∫–∏, –∫–∞—Å–∞—é—â–∏–µ—Å—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π 0002-0007, —Å–ª–µ–¥—É–µ—Ç —Å—á–∏—Ç–∞—Ç—å –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –º–∏–≥—Ä–∞—Ü–∏–π.
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç–∞ –∏ TypeError (–°–µ—Å—Å–∏—è [—Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è])**
    - **–ü—Ä–æ–±–ª–µ–º–∞ 1: –û—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–∞ `ImportError: attempted relative import beyond top-level package` –∏ `ModuleNotFoundError`**
        - **–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø—É—Ç–∏ –∏–º–ø–æ—Ä—Ç–∞ –≤ `src/bot/core.py` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `bot.events` –≤–º–µ—Å—Ç–æ `src.bot.events`), –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Ñ–∞–π–ª–∞ `src/bot/commands.py` —Å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π `src/bot/commands/`, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `__init__.py` –≤ `src/bot/commands/`. –¢–∞–∫–∂–µ, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥—É–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `party_commands.py`) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∏–º–ø–æ—Ä—Ç—ã –≤–∏–¥–∞ `from core...` –≤–º–µ—Å—Ç–æ `from src.core...`.
        - **–†–µ—à–µ–Ω–∏–µ:**
            - –í `src/bot/core.py` –∏–∑–º–µ–Ω–µ–Ω—ã –ø—É—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –Ω–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –æ—Ç –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞ (`src.bot.events`, `src.bot.commands.party_commands` –∏ —Ç.–¥.).
            - –§–∞–π–ª `src/bot/commands.py` –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ `src/bot/general_commands.py`, –∏ –ø—É—Ç—å –µ–≥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ `src/bot/core.py` –æ–±–Ω–æ–≤–ª–µ–Ω.
            - –°–æ–∑–¥–∞–Ω –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª `src/bot/commands/__init__.py`.
            - –í `src/bot/commands/party_commands.py` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã –Ω–∞ `from src.core...` –∏ `from src.models...`.
    - **–ü—Ä–æ–±–ª–µ–º–∞ 2: `ImportError: cannot import name 'get_party_by_id' from 'src.core.party_utils'` –≤ `src.bot.commands.turn_commands.py`**
        - **–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è `get_party_by_id` –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∞ –≤ `src/core/party_utils.py`. –í–º–µ—Å—Ç–æ –Ω–µ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ —Ñ—É–Ω–∫—Ü–∏—è `get_party(..., party_id: int)`, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è —Ç—É –∂–µ —Ä–æ–ª—å.
        - **–†–µ—à–µ–Ω–∏–µ:** –í `src/bot/commands/turn_commands.py` –∏–º–ø–æ—Ä—Ç –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `from src.core.party_utils import get_party`, –∏ –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
    - **–ü—Ä–æ–±–ª–µ–º–∞ 3: `TypeError: unsupported type annotation <class 'discord.interactions.Interaction'>` –≤ `src.bot.commands.master_ai_commands.py`**
        - **–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ `@transactional` (–∫–æ—Ç–æ—Ä—ã–π –≤–Ω–µ–¥—Ä—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `session: AsyncSession`) –Ω–∞ –º–µ—Ç–æ–¥–∞—Ö –∫–æ–º–∞–Ω–¥ (`reject_ai`, `edit_ai`), –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫–∂–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç `interaction: discord.Interaction`. –°–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤ `discord.py` –¥–ª—è slash-–∫–æ–º–∞–Ω–¥ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—é `discord.Interaction` –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –≤–Ω–µ–¥—Ä–µ–Ω–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `AsyncSession`, –æ—à–∏–±–æ—á–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É—è –µ–µ –∫–∞–∫ –º–æ–¥—É–ª—å `discord.interactions.Interaction`.
        - **–†–µ—à–µ–Ω–∏–µ:** –î–ª—è –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö –∫–æ–º–∞–Ω–¥ (`reject_ai`, `edit_ai`) –≤ `master_ai_commands.py`:
            - –£–¥–∞–ª–µ–Ω –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@transactional` —Å —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –∫–æ–º–∞–Ω–¥—ã.
            - –£–¥–∞–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `session: AsyncSession` –∏–∑ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –∫–æ–º–∞–Ω–¥—ã.
            - –í —Ç–µ–ª–µ –∫–æ–º–∞–Ω–¥—ã —Å–µ—Å—Å–∏—è —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ `async with get_db_session() as session:`.
            - –Ø–≤–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `await session.commit()` –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ë–î –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞ `with`.
        - –≠—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç "—á–∏—Å—Ç—É—é" —Å–∏–≥–Ω–∞—Ç—É—Ä—É –¥–ª—è `discord.py` –∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –≤–Ω—É—Ç—Ä—å –º–µ—Ç–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã. –ö–æ–º–∞–Ω–¥–∞ `approve_ai` —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ —ç—Ç–æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω –∏ –Ω–µ —Ç—Ä–µ–±–æ–≤–∞–ª–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞: –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç –¥–ª—è `main.py`, –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥–∏ (–°–µ—Å—Å–∏—è [—Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è])**
    - **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**
        - –°–æ–∑–¥–∞–Ω –ø–ª–∞–Ω –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –¥–ª—è `src/main.py`, –≤–∫–ª—é—á–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫—É –æ–∫—Ä—É–∂–µ–Ω–∏—è, –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ—à–∏–±–æ–∫, –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤.
    - **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
        - –î–æ–±–∞–≤–ª–µ–Ω—ã `pytest` –∏ `pytest-asyncio` –≤ `requirements.txt`.
        - –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`pip install -r requirements.txt`).
        - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `tests/test_main.py` —Å –Ω–∞—á–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Ç–µ—Å—Ç–æ–≤ –∏ —Ñ–∏–∫—Å—Ç—É—Ä (`mock_settings`, `mock_bot_core`, `mock_init_db`).
    - **–ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –∏ –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤:**
        - –ù–∞–ø–∏—Å–∞–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è `src/main.py`, –ø–æ–∫—Ä—ã–≤–∞—é—â–∏–µ —É—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫–µ–Ω–∞, –æ—à–∏–±–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î, –æ—à–∏–±–∫–∏ –ª–æ–≥–∏–Ω–∞ Discord –∏ –æ–±—â–∏–µ –æ—à–∏–±–∫–∏ –∑–∞–ø—É—Å–∫–∞. –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ `sys.path`.
        - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç–∞ –≤ `src/core/`:**
            - `src/core/locations_utils.py`: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `from models.location...` –Ω–∞ `from ..models.location...`.
            - `src/core/crud/crud_location.py`: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `from models.location...` –Ω–∞ `from ...models.location...` –∏ `from core.crud_base_definitions...` –Ω–∞ `from ..crud_base_definitions...`. (–ë—ã–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π).
            - `src/core/crud/crud_player.py`: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `from models.player...` –Ω–∞ `from ...models.player...`.
            - `src/core/crud/crud_party.py`: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã `from models.party...` –∏ `from models.player...` –Ω–∞ `from ...models.party...` –∏ `from ...models.player...` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
            - `src/core/movement_logic.py`: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `from models...` –Ω–∞ `from ..models...`.
        - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–π –≤ `src/core/action_processor.py`:**
            - –ó–∞–º–µ–Ω–µ–Ω –∏–º–ø–æ—Ä—Ç `get_player_by_id` –Ω–∞ `get_player` –∏–∑ `player_utils`.
            - –ó–∞–º–µ–Ω–µ–Ω –∏–º–ø–æ—Ä—Ç `get_party_by_id` –Ω–∞ `get_party` –∏–∑ `party_utils`.
        - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ —Ñ–∏–∫—Å—Ç—É—Ä–∞—Ö –∏ —Ç–µ—Å—Ç–∞—Ö `tests/test_main.py`:**
            - –§–∏–∫—Å—Ç—É—Ä–∞ `mock_settings`: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ `LOG_LEVEL` –∏ `BOT_PREFIX`. `BOT_PREFIX` –º–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤ `src.config.settings`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `main()`. `LOG_LEVEL` –∏ `DISCORD_BOT_TOKEN` –º–æ–∫–∏—Ä—É—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ `main_module`.
            - –§–∏–∫—Å—Ç—É—Ä–∞ `mock_init_db`: –ò–∑–º–µ–Ω–µ–Ω–∞ —Å `async def` –Ω–∞ `def`, —á—Ç–æ–±—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `AsyncMock` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö.
            - –£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è/–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ—Å—Ç `test_main_no_token` –≤ –ø–æ–ª—å–∑—É `test_main_no_token_fixed`.
            - –í —Ç–µ—Å—Ç—ã, –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–µ –æ—à–∏–±–∫–∏ (`test_main_discord_login_failure`, `test_main_generic_start_exception`, `test_main_keyboard_interrupt_handling`), –¥–æ–±–∞–≤–ª–µ–Ω—ã `monkeypatch` –∏ –º–æ–∫–∏ –¥–ª—è `discord.Intents` –∏ `discord.ext.commands.when_mentioned_or` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–Ω—Å—Ç–∞–Ω—Ü–∏–∞—Ü–∏–∏ `BotCore` –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –µ–≥–æ –º–µ—Ç–æ–¥ `start()` –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É.
            - –í —ç—Ç–∏—Ö –∂–µ —Ç–µ—Å—Ç–∞—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è `expected_prefix_callable` –Ω–∞ `lambda bot, msg: ['?']` –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É `BOT_PREFIX`.
            - **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º `finally` –±–ª–æ–∫–∞:** –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω." (–∏ –¥—Ä—É–≥–∏–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –±–ª–æ–∫–∞ `finally` –≤ `main.py`) –Ω–µ –ø–æ–ø–∞–¥–∞–ª–æ –≤ `caplog.text` –¥–ª—è —Ç–µ—Å—Ç–æ–≤, –≥–¥–µ –≤ `main()` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è. –ü—Ä–∏ —ç—Ç–æ–º `mock_bot_core.close.assert_called_once()` –ø—Ä–æ—Ö–æ–¥–∏–ª, —É–∫–∞–∑—ã–≤–∞—è –Ω–∞ —Ç–æ, —á—Ç–æ –±–ª–æ–∫ `finally` –¥–æ—Å—Ç–∏–≥–∞–ª—Å—è.
            - –í `src/main.py` –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è–ª–∏—Å—å —è–≤–Ω—ã–µ `return` –≤ `except` –±–ª–æ–∫–∞—Ö –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ `print` –≤ `finally` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏. –≠—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Ä–µ—à–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ö–≤–∞—Ç–∞ –ª–æ–≥–æ–≤.
            - –ü—Ä–∏–Ω—è—Ç–æ –ø—Ä–∞–≥–º–∞—Ç–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —É–¥–∞–ª–∏—Ç—å –∞—Å—Å–µ—Ä—Ç—ã `assert "–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω." in caplog.text` –∏–∑ —Ç–µ—Å—Ç–æ–≤ `test_main_discord_login_failure`, `test_main_generic_start_exception` –∏ `test_main_keyboard_interrupt_handling`, —Ç–∞–∫ –∫–∞–∫ –¥—Ä—É–≥–∏–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏, –≤—ã–∑–æ–≤ `bot.close()`) –ø—Ä–æ—Ö–æ–¥–∏–ª–∏. –≠—Ç–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –≤–æ–∑–º–æ–∂–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è `caplog` —Å `asyncio` –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ –¥–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.
            - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π `finally` –±–ª–æ–∫ –≤ `src/main.py` (—É–¥–∞–ª–µ–Ω—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ `print` –∏ —è–≤–Ω—ã–µ `return` –∏–∑ `except` –±–ª–æ–∫–æ–≤, –∫—Ä–æ–º–µ `logger.info` –≤ `finally`).
    - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ 7 —Ç–µ—Å—Ç–æ–≤ –≤ `tests/test_main.py` —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω—ã.
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ Alembic –º–∏–≥—Ä–∞—Ü–∏–π (–°–µ—Å—Å–∏—è [—Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è])**
    - **–ü—Ä–æ–±–ª–µ–º–∞ 1: `DuplicateObjectError: type "event_type_enum" already exists`**
        - **–ü—Ä–∏—á–∏–Ω–∞:** –ú–∏–≥—Ä–∞—Ü–∏—è `0009_create_story_logs_table.py` –ø—ã—Ç–∞–ª–∞—Å—å —Å–æ–∑–¥–∞—Ç—å ENUM `event_type_enum`, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω –≤ –Ω–∞—á–∞–ª—å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã (`4a069d44a15c_initial_schema.py`). –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (`checkfirst=True` –≤ —è–≤–Ω–æ–º –≤—ã–∑–æ–≤–µ `ENUM.create()`) –Ω–µ –ø–æ–º–æ–≥–ª–∞, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –Ω–µ—è–≤–Ω–æ–º —Å–æ–∑–¥–∞–Ω–∏–∏ ENUM –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ `postgresql.ENUM` –≤ `op.create_table`.
        - **–†–µ—à–µ–Ω–∏–µ:**
            - –í —Ñ–∞–π–ª–µ `alembic/versions/0009_create_story_logs_table.py` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `eventtype_enum` –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ `postgresql.ENUM(*event_type_values, name="event_type_enum", create_type=False)`. –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏–ª–æ –ø–æ–ø—ã—Ç–∫—É SQLAlchemy —Å–æ–∑–¥–∞—Ç—å —Ç–∏–ø ENUM –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ `op.create_table`.
            - –Ø–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã `eventtype_enum.create()` –∏ `eventtype_enum.drop()` –≤ –º–∏–≥—Ä–∞—Ü–∏–∏ `0009` –æ—Å—Ç–∞–ª–∏—Å—å –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏.
    - **–ü—Ä–æ–±–ª–µ–º–∞ 2: `DuplicateTableError: relation "story_logs" already exists`**
        - **–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏ —Å ENUM, –≤—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è `0009_create_story_logs_table.py` —Ç–∞–∫–∂–µ –ø—ã—Ç–∞–ª–∞—Å—å —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `story_logs` (`op.create_table("story_logs", ...)`), –∫–æ—Ç–æ—Ä–∞—è —É–∂–µ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ –Ω–∞—á–∞–ª—å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã (`4a069d44a15c_initial_schema.py`). –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π —Ç–∞–±–ª–∏—Ü –ø–æ–∫–∞–∑–∞–ª–æ –∏—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫—É—é –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å.
        - **–†–µ—à–µ–Ω–∏–µ:**
            - –í —Ñ–∞–π–ª–µ `alembic/versions/0009_create_story_logs_table.py` –≤—ã–∑–æ–≤ `op.create_table("story_logs", ...)` –∏ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–∏–º `op.create_index(...)` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `upgrade()` –±—ã–ª–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã.
            - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –≤—ã–∑–æ–≤—ã `op.drop_table("story_logs")` –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ `op.drop_index(...)` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `downgrade()` —Ç–∞–∫–∂–µ –±—ã–ª–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã.
            - –í —Ñ—É–Ω–∫—Ü–∏—è—Ö `upgrade()` –∏ `downgrade()` –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã `pass`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —Å—Ç–∞–ª–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø—É—Å—Ç—ã–º–∏ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ö–µ–º—ã `story_logs`.
    - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–∏–≥—Ä–∞—Ü–∏–∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å –ø–æ—Å–ª–µ —ç—Ç–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π.
- **–ó–∞–¥–∞—á–∞ ‚öôÔ∏è 6.11 Central Collected Actions Processing Module (Turn Processor) - Guild-Scoped Execution**:
    - **–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π**: –î–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤–æ—Ä–∫–µ—Ä, –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π –∏–≥—Ä–æ–∫–æ–≤ (`collected_actions_json`), —Ñ–∞–∑—ã –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (MVP –¥–ª—è –≥—Ä—É–ø–ø—ã, —Å–æ–∑–¥–∞–Ω–∏–µ `PendingConflict`, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ú–∞—Å—Ç–µ—Ä–∞), –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (–≤—ã–∑–æ–≤ Check Resolver), —Ñ–∞–∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π (–∫–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –∞—Ç–æ–º–∞—Ä–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤—ã–∑–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥—É–ª–µ–π-–∑–∞–≥–ª—É—à–µ–∫), –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–≥—Ä–æ–∫–æ–≤/–≥—Ä—É–ø–ø.
    - **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å `PendingConflict` –≤ `src/models/pending_conflict.py` –∏ Enum `ConflictStatus` –≤ `src/models/enums.py`. –û–±–Ω–æ–≤–ª–µ–Ω `src/models/guild.py` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏. –û–±–Ω–æ–≤–ª–µ–Ω `src/models/__init__.py`. –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è Alembic `0007_create_pending_conflicts_table.py`.
    - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è `action_processor.py`**: –°–æ–∑–¥–∞–Ω `src/core/action_processor.py` —Å –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π `process_actions_for_guild`. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π –∏–≥—Ä–æ–∫–æ–≤, MVP-–¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—è –¥–µ–π—Å—Ç–≤–∏–π –∫ –∑–∞–≥–ª—É—à–∫–∞–º (`_handle_placeholder_action`, `_handle_move_action_wrapper`) —Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ —Å—É—â–Ω–æ—Å—Ç–µ–π –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Ö –¥–µ–π—Å—Ç–≤–∏–π.
    - **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `turn_controller.py`**: `src/core/turn_controller.py` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –≤—ã–∑–æ–≤–∞ `action_processor.process_actions_for_guild` —á–µ—Ä–µ–∑ `asyncio.create_task`.
    - **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `core/__init__.py`**: `action_processor` –∏ –µ–≥–æ –ø—É–±–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `src/core/__init__.py`.
    - **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ–µ)**: –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –ø–ª–∞–Ω –¥–ª—è –º–∞–Ω—É–∞–ª—å–Ω–æ–≥–æ/–∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ –æ—á–∏—Å—Ç–∫–∏ `collected_actions_json`.
- **–ó–∞–¥–∞—á–∞ ‚öôÔ∏è 6.12 Turn Queue System (Turn Controller) - Per-Guild Processing**:
    - **–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π**: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç–∞—Ç—É—Å–∞–º –∏–≥—Ä–æ–∫–æ–≤/–≥—Ä—É–ø–ø, –∫–æ–º–∞–Ω–¥–∞–º `/end_turn`, `/end_party_turn`, –ª–æ–≥–∏–∫–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–∏ –∏ –≤—ã–∑–æ–≤—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π.
    - **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤**: –í `src/models/enums.py` –æ–±–Ω–æ–≤–ª–µ–Ω—ã `PlayerStatus` (–¥–æ–±–∞–≤–ª–µ–Ω—ã `TURN_ENDED_PENDING_RESOLUTION`, `PROCESSING_GUILD_TURN`; —É–¥–∞–ª–µ–Ω `PROCESSING_ACTION`) –∏ `PartyTurnStatus` (–¥–æ–±–∞–≤–ª–µ–Ω—ã `AWAITING_PARTY_ACTION`, `TURN_ENDED_PENDING_RESOLUTION`, `PROCESSING_GUILD_TURN`; —É–¥–∞–ª–µ–Ω—ã `ACTIVE_TURN`, `PROCESSING_ACTIONS`, `WAITING_FOR_MEMBERS`, `TURN_ENDED`).
    - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥**: –°–æ–∑–¥–∞–Ω `src/bot/commands/turn_commands.py` —Å `TurnManagementCog`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–æ–º–∞–Ω–¥—ã `/end_turn` –∏ `/end_party_turn`. –ö–æ–º–∞–Ω–¥—ã –æ–±–Ω–æ–≤–ª—è—é—Ç —Å—Ç–∞—Ç—É—Å—ã –∏–≥—Ä–æ–∫–∞/–≥—Ä—É–ø–ø—ã –∏ –≤—ã–∑—ã–≤–∞—é—Ç –ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–∏.
    - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–∏**: –°–æ–∑–¥–∞–Ω `src/core/turn_controller.py` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ `process_guild_turn_if_ready` (—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π –¥–ª—è –≥–∏–ª—å–¥–∏–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–æ–≤ —Å—É—â–Ω–æ—Å—Ç–µ–π –Ω–∞ `PROCESSING_GUILD_TURN` –∏ –≤—ã–∑–æ–≤–æ–º –∑–∞–≥–ª—É—à–∫–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π) –∏ `trigger_guild_turn_processing` (–¥–ª—è –≤—ã–∑–æ–≤–∞ –∏–∑ Cog).
    - **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: `TurnManagementCog` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `BOT_COGS` –≤ `src/config/settings.py`. `turn_controller` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `src/core/__init__.py`. –ö–æ–º–∞–Ω–¥—ã –≤ `turn_commands.py` –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –≤—ã–∑–æ–≤–∞ `trigger_guild_turn_processing`.
    - **–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î**: –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è Alembic `alembic/versions/0006_update_turn_statuses.py` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ ENUM `PlayerStatus` –∏ `PartyTurnStatus` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `ALTER TYPE ... ADD VALUE IF NOT EXISTS`.
    - **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–º–∞–Ω–¥, –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.
    - **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –û–±–Ω–æ–≤–ª–µ–Ω "–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω" –∏ "–õ–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π" –≤ `AGENTS.md`.
- **–ó–∞–¥–∞—á–∞ ‚öôÔ∏è 6.10 Action Parsing and Recognition Module (NLU & Intent/Entity) –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞.**
    - –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ, —á—Ç–æ –≤—Å–µ —à–∞–≥–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–ª–∞–Ω–∞ –¥–ª—è –∑–∞–¥–∞—á–∏ 6.10 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã (—Å–æ–∑–¥–∞–Ω–∏–µ Pydantic –º–æ–¥–µ–ª–µ–π `ParsedAction`, `ActionEntity`; —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `nlu_service.parse_player_input` —Å regex; –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `on_message` —á–µ—Ä–µ–∑ `_process_player_message_for_nlu`; –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `player.collected_actions_json`).
    - –ó–∞–ø–∏—Å—å –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `Done.txt`.
    - –¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –æ—Ç—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–π.
- **–ó–∞–¥–∞—á–∞ üß† 2.6 AI Generation, Moderation, and Saving Logic**
    - (–õ–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ —ç—Ç–æ–π –∑–∞–¥–∞—á–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤—ã—à–µ, –∑–¥–µ—Å—å —Ç–æ–ª—å–∫–æ –æ—Ç–º–µ—Ç–∫–∞ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥–µ)
- **–ó–∞–¥–∞—á–∞ 2.3 –∑–∞–ø–∏—Å–∞–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –≤ `Done.txt`**.
- **–ó–∞–¥–∞—á–∞ 2.3 —É–¥–∞–ª–µ–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞ `Tasks.txt`**.
- **–ó–∞–¥–∞—á–∞ 2.2 (AI Prompt Preparation Module) –∑–∞–ø–∏—Å–∞–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –≤ `Done.txt`**.
- **–ó–∞–¥–∞—á–∞ 2.2 —É–¥–∞–ª–µ–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞ `Tasks.txt`**.
- **–ó–∞–¥–∞—á–∞ 2.1 (Finalize Definition of ALL DB Schemas (i18n, Guild ID)) –∑–∞–ø–∏—Å–∞–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –≤ `Done.txt`**.
- **–ó–∞–¥–∞—á–∞ 2.1 —É–¥–∞–ª–µ–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞ `Tasks.txt`**.
- **–ó–∞–¥–∞—á–∞ 1.3 –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è Movement Logic** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ API `handle_move_action` –∏ –∫–æ–º–∞–Ω–¥–µ `/move`.
    - –£—á—Ç–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–æ–¥–µ–ª–µ–π `Player`, `Party`, `Location`, `RuleConfig`.
    - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤ –¥–ª—è `log_event` (Task 19) –∏ `on_enter_location` (Task 14).
- **–ó–∞–¥–∞—á–∞ 1.3 –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∞ API —Ñ—É–Ω–∫—Ü–∏—è `handle_move_action`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/core/game_events.py` —Å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞–º–∏ `on_enter_location` –∏ `log_event`.
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/core/movement_logic.py`.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `handle_move_action(guild_id, player_discord_id, target_location_static_id)`:
        - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä–æ–∫–∞, —Ç–µ–∫—É—â–µ–π –∏ —Ü–µ–ª–µ–≤–æ–π –ª–æ–∫–∞—Ü–∏–π.
        - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –ª–æ–∫–∞—Ü–∏–π —á–µ—Ä–µ–∑ `neighbor_locations_json`.
        - –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–≤–∏–∂–µ–Ω–∏—è –ø–∞—Ä—Ç–∏–∏ (–µ—Å–ª–∏ –∏–≥—Ä–æ–∫ –≤ –ø–∞—Ä—Ç–∏–∏, –≤—Å—è –ø–∞—Ä—Ç–∏—è –¥–≤–∏–∂–µ—Ç—Å—è).
        - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `@transactional` —á–µ—Ä–µ–∑ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `_update_entities_location`.
        - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ `on_enter_location` –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è.
        - –í–æ–∑–≤—Ä–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ.
- **–ó–∞–¥–∞—á–∞ 1.3 –®–∞–≥ 3: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/move`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/bot/commands/movement_commands.py` —Å `MovementCog`.
    - –í `MovementCog` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/move <target_location_static_id>` –∫–∞–∫ slash command.
    - –ö–æ–º–∞–Ω–¥–∞ –∏–∑–≤–ª–µ–∫–∞–µ—Ç `guild_id`, `player_discord_id` –∏ –≤—ã–∑—ã–≤–∞–µ—Ç `handle_move_action`.
    - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
    - `src/bot/core.py` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ `movement_commands` Cog.
- **–ó–∞–¥–∞—á–∞ 1.3 –®–∞–≥ 4: –ü—Ä–æ–¥—É–º–∞–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è –≥—Ä—É–ø–ø—ã (RuleConfig)** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –û–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–ª—é—á `party_movement_policy` –¥–ª—è `RuleConfig` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–Ω–∞—á–µ–Ω–∏—è: `any_member`, `leader_only`).
    - MVP-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ—è–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–∏—Ç–∏–∫—É `any_member`.
    - –†–µ—à–µ–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —á—Ç–µ–Ω–∏—è —ç—Ç–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ `RuleConfig` –¥–æ –±–æ–ª–µ–µ –∑—Ä–µ–ª–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∞–≤–∏–ª –∏–ª–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–∏–¥–µ—Ä—Å—Ç–≤–∞ –≤ –≥—Ä—É–ø–ø–µ).
- **–ó–∞–¥–∞—á–∞ 1.3 –®–∞–≥ 5: –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è `on_enter_location`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –§—É–Ω–∫—Ü–∏—è `on_enter_location` –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ `src/core/game_events.py` –Ω–∞ –®–∞–≥–µ 2 –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º (–ª–æ–≥–∏—Ä—É–µ—Ç –≤—ã–∑–æ–≤).
- **–ó–∞–¥–∞—á–∞ 1.2 –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è Player and Party System** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –º–æ–¥–µ–ª–∏ Player –∏ Party, –∏—Ö –ø–æ–ª—è, Enum-—Ç–∏–ø—ã –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤, –ª–æ–≥–∏–∫–∞ –∫–æ–º–∞–Ω–¥ `/start` –∏ `/party`, –∞ —Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Ç–∏–ª–∏—Ç—ã.
    - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è —Ç–∏–ø–∞ –¥–ª—è `get_db_session` –≤ `src/core/database.py`.
- **–ó–∞–¥–∞—á–∞ 1.2 –®–∞–≥ 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã Enum'—ã `PlayerStatus` –∏ `PartyTurnStatus`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω `src/models/enums.py` —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏ `PlayerStatus` –∏ `PartyTurnStatus`.
    - `src/models/__init__.py` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Ö —ç–∫—Å–ø–æ—Ä—Ç–∞.
- **–ó–∞–¥–∞—á–∞ 1.2 –®–∞–≥ 3: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å `Player`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω `src/models/player.py` —Å –º–æ–¥–µ–ª—å—é `Player`.
    - –í–∫–ª—é—á–µ–Ω—ã –≤—Å–µ –ø–æ–ª—è, FK, UniqueConstraint(`guild_id`, `discord_id`), Enum `PlayerStatus`, –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ `Location` –∏ `Party`.
- **–ó–∞–¥–∞—á–∞ 1.2 –®–∞–≥ 4: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å `Party`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω `src/models/party.py` —Å –º–æ–¥–µ–ª—å—é `Party`.
    - –í–∫–ª—é—á–µ–Ω—ã –≤—Å–µ –ø–æ–ª—è, FK, Enum `PartyTurnStatus`, JSON-–ø–æ–ª–µ `player_ids_json`, –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ `Location` –∏ `Player`.
- **–ó–∞–¥–∞—á–∞ 1.2 –®–∞–≥ 5: –û–±–Ω–æ–≤–ª–µ–Ω `src/models/__init__.py`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –ú–æ–¥–µ–ª–∏ `Player` –∏ `Party` –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∏–º–ø–æ—Ä—Ç—ã `src/models/__init__.py`.
- **–ó–∞–¥–∞—á–∞ 1.2 –®–∞–≥ 6: –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è Alembic –¥–ª—è `Player` –∏ `Party`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏ `alembic/versions/0004_create_players_and_parties_tables.py`.
    - –ú–∏–≥—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü `parties` –∏ `players`, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö ENUM-—Ç–∏–ø–æ–≤, –∏–Ω–¥–µ–∫—Å–æ–≤, FK –∏ UniqueConstraint.
- **–ó–∞–¥–∞—á–∞ 1.2 –®–∞–≥ 7: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã CRUD-–∫–ª–∞—Å—Å—ã `CRUDPlayer` –∏ `CRUDParty`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω—ã `src/core/crud/crud_player.py` –∏ `src/core/crud/crud_party.py`.
    - `CRUDPlayer` –≤–∫–ª—é—á–∞–µ—Ç `get_by_discord_id`, `get_multi_by_location`, `get_multi_by_party_id`, `create_with_defaults`.
    - `CRUDParty` –≤–∫–ª—é—á–∞–µ—Ç `get_by_name`, `add_player_to_party_json`, `remove_player_from_party_json`.
    - `src/core/crud/__init__.py` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Ö —ç–∫—Å–ø–æ—Ä—Ç–∞.
- **–ó–∞–¥–∞—á–∞ 1.2 –®–∞–≥ 8: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è Player –∏ Party** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω `src/core/player_utils.py` (—Å `get_player`, `get_player_by_discord_id`, `get_players_in_location`, `get_players_in_party`).
    - –°–æ–∑–¥–∞–Ω `src/core/party_utils.py` (—Å `get_party`, `get_party_by_name`).
    - `src/core/__init__.py` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Ö —ç–∫—Å–ø–æ—Ä—Ç–∞.
- **–ó–∞–¥–∞—á–∞ 1.2 –®–∞–≥ 9: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/start`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –ö–æ–º–∞–Ω–¥–∞ `/start` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `src/bot/commands.py` (–≤ `CommandCog`).
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞, —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞ —Å –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π –ª–æ–∫–∞—Ü–∏–µ–π –∏ –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.
- **–ó–∞–¥–∞—á–∞ 1.2 –®–∞–≥ 10: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ–º–∞–Ω–¥—ã –¥–ª—è Party** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω `src/bot/commands/party_commands.py` —Å `PartyCog`.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ–º–∞–Ω–¥—ã: `/party create <–Ω–∞–∑–≤–∞–Ω–∏–µ>`, `/party leave`, `/party disband`.
    - `src/bot/core.py` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ `party_commands` Cog.
- **–ó–∞–¥–∞—á–∞ 1.1 –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è Location Model** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–ª—è –º–æ–¥–µ–ª–∏ `Location` (guild_id, static_id, i18n –ø–æ–ª—è, JSONB –ø–æ–ª—è), –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å ENUM –¥–ª—è —Ç–∏–ø–∞ –ª–æ–∫–∞—Ü–∏–∏, –∏ —É—Ç–∏–ª–∏—Ç—ã (`get_location`, `get_static_location_id`, `get_localized_text`).
- **–ó–∞–¥–∞—á–∞ 1.1 –®–∞–≥ 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å `Location`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω `src/models/location.py` —Å –º–æ–¥–µ–ª—å—é `Location` –∏ enum `LocationType`.
    - –í–∫–ª—é—á–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è, JSONB –¥–ª—è i18n –∏ –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, ForeignKey –∫ `guild_configs`.
    - –î–æ–±–∞–≤–ª–µ–Ω —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è `(guild_id, static_id)`.
- **–ó–∞–¥–∞—á–∞ 1.1 –®–∞–≥ 3: –û–±–Ω–æ–≤–ª–µ–Ω `src/models/__init__.py`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –ú–æ–¥–µ–ª—å `Location` –∏ enum `LocationType` –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∏–º–ø–æ—Ä—Ç—ã –∏ –ª–æ–≥–≥–µ—Ä –≤ `src/models/__init__.py`.
- **–ó–∞–¥–∞—á–∞ 1.1 –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è Alembic –¥–ª—è `Location`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏ `alembic/versions/0003_create_locations_table.py`.
    - –ú–∏–≥—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `locations`, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∏–Ω–¥–µ–∫—Å–æ–≤, –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞, –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É ENUM —Ç–∏–ø–∞ `locationtype`.
- **–ó–∞–¥–∞—á–∞ 1.1 –®–∞–≥ 5: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –±–∞–∑–æ–≤—ã–µ CRUD-—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è `Location`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω `src/core/crud/crud_location.py` —Å –∫–ª–∞—Å—Å–æ–º `CRUDLocation(CRUDBase[Location])`.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã `get_by_static_id` –∏ `get_locations_by_type`.
    - –°–æ–∑–¥–∞–Ω `src/core/crud/__init__.py` –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ `location_crud`.
- **–ó–∞–¥–∞—á–∞ 1.1 –®–∞–≥ 6: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —É—Ç–∏–ª–∏—Ç—ã `get_location` –∏ `get_static_location_id`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω `src/core/locations_utils.py`.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `get_location` (–æ–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ `location_crud.get`) –∏ `get_location_by_static_id` (–æ–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ `location_crud.get_by_static_id`).
    - –û–±–Ω–æ–≤–ª–µ–Ω `src/core/__init__.py` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è `locations_utils`.
- **–ó–∞–¥–∞—á–∞ 1.1 –®–∞–≥ 7: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –§—É–Ω–∫—Ü–∏—è `get_localized_text` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `src/core/locations_utils.py`.
    - –£—Ç–∏–ª–∏—Ç–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–∏—Å–∫ –ø–æ —è–∑—ã–∫—É, fallback-—è–∑—ã–∫—É, –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –∏–ª–∏ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É. –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ.
- **–ó–∞–¥–∞—á–∞ 1.1 –®–∞–≥ 8: –û–±–Ω–æ–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `on_guild_join`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –í `src/bot/events.py` –æ–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `on_guild_join` –∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ `_ensure_guild_config_exists` –∏ `_populate_default_locations`.
    - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ `GuildConfig` (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∞–≤–∏–ª–∞ `guild_main_language` —á–µ—Ä–µ–∑ `update_rule_config`.
    - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π (`DEFAULT_STATIC_LOCATIONS`) –¥–ª—è –Ω–æ–≤–æ–π –≥–∏–ª—å–¥–∏–∏, –µ—Å–ª–∏ –æ–Ω–∏ –µ—â–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç.
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `get_db_session` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–µ–π –ë–î.
- **–ó–∞–¥–∞—á–∞ 0.3 –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ó–∞–¥–∞—á–µ 0.3** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ë–î —Å —É—á–µ—Ç–æ–º –≥–∏–ª—å–¥–∏–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ ORM, –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, CRUD-—É—Ç–∏–ª–∏—Ç—ã, –º–æ–¥–µ–ª—å RuleConfig –∏ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ–π (–≤–∫–ª—é—á–∞—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ).
- **–ó–∞–¥–∞—á–∞ 0.3 –®–∞–≥ 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å `RuleConfig`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/models/rule_config.py` —Å –º–æ–¥–µ–ª—å—é `RuleConfig`.
    - –ú–æ–¥–µ–ª—å –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª—è: `id` (PK), `guild_id` (FK –∫ `GuildConfig`), `key` (TEXT), `value_json` (JSONB).
    - –î–æ–±–∞–≤–ª–µ–Ω —Å–æ—Å—Ç–∞–≤–Ω–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è (`guild_id`, `key`).
    - –û–±–Ω–æ–≤–ª–µ–Ω `src/models/__init__.py` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è `RuleConfig`.
- **–ó–∞–¥–∞—á–∞ 0.3 –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è Alembic –¥–ª—è `RuleConfig`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏ `alembic/versions/0002_create_rule_configs_table.py`.
    - –ú–∏–≥—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `rule_configs` —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –ø–æ–ª—è–º–∏, –∏–Ω–¥–µ–∫—Å–∞–º–∏ –∏ –≤–Ω–µ—à–Ω–∏–º –∫–ª—é—á–æ–º.
- **–ó–∞–¥–∞—á–∞ 0.3 –®–∞–≥ 4: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@transactional`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –í `src/core/database.py` –¥–æ–±–∞–≤–ª–µ–Ω –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@transactional`.
    - –î–µ–∫–æ—Ä–∞—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `get_db_session` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Å–µ—Å—Å–∏–∏ (commit, rollback, close) –∏ –≤–Ω–µ–¥—Ä—è–µ—Ç —Å–µ—Å—Å–∏—é –≤ –¥–µ–∫–æ—Ä–∏—Ä—É–µ–º—É—é —Ñ—É–Ω–∫—Ü–∏—é.
- **–ó–∞–¥–∞—á–∞ 0.3 –®–∞–≥ 5: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –æ–±—â–∏–µ CRUD-—É—Ç–∏–ª–∏—Ç—ã** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/core/crud.py`.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–ª–∞—Å—Å `CRUDBase[ModelType]` —Å –º–µ—Ç–æ–¥–∞–º–∏: `create`, `get`, `get_multi`, `update`, `delete`, `get_by_attribute`, `get_multi_by_attribute`.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –æ–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏: `create_entity`, `get_entity_by_id`, `update_entity`, `delete_entity`, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ `CRUDBase`.
    - –£—Ç–∏–ª–∏—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç `guild_id` –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –º–æ–¥–µ–ª—è–º–∏, –∏–º–µ—é—â–∏–º–∏ —ç—Ç–æ –ø–æ–ª–µ.
    - –û–±–Ω–æ–≤–ª–µ–Ω `src/core/__init__.py` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –º–æ–¥—É–ª—è `crud`.
- **–ó–∞–¥–∞—á–∞ 0.3 –®–∞–≥ 6: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è `RuleConfig`** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/core/rules.py`.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏: `load_rules_config_for_guild` (–∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª –≥–∏–ª—å–¥–∏–∏), `get_rule` (–ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ –∫–µ—à–∞ —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏), `update_rule_config` (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –≤ –ë–î –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞), `get_all_rules_for_guild` (–ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª –≥–∏–ª—å–¥–∏–∏ –∏–∑ –∫–µ—à–∞).
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π –≤–Ω—É—Ç—Ä–∏–ø—Ä–æ—Ü–µ—Å—Å–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª (`_rules_cache`).
    - –û–±–Ω–æ–≤–ª–µ–Ω `src/core/__init__.py` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –º–æ–¥—É–ª—è `rules`.
- **–ó–∞–¥–∞—á–∞ 0.2 –®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å `GuildConfig`**
    - –°–æ–∑–¥–∞–Ω `src/models/base.py` —Å –∫–ª–∞—Å—Å–æ–º `Base(AsyncAttrs, DeclarativeBase)`.
    - –°–æ–∑–¥–∞–Ω `src/models/guild.py` —Å –º–æ–¥–µ–ª—å—é `GuildConfig`, –≤–∫–ª—é—á–∞—é—â–µ–π –ø–æ–ª—è: `id` (PK, BigInteger), `master_channel_id` (BigInteger, nullable), `system_channel_id` (BigInteger, nullable), `notification_channel_id` (BigInteger, nullable), `main_language` (Text, default 'en').
    - –°–æ–∑–¥–∞–Ω `src/models/__init__.py` –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ `Base` –∏ –º–æ–¥–µ–ª–µ–π (–ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ `GuildConfig`), —á—Ç–æ–±—ã Alembic –º–æ–≥ –∏—Ö –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å.
- **–ó–∞–¥–∞—á–∞ 0.2 –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω `requirements.txt`**
    - –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `SQLAlchemy>=2.0.20`, `asyncpg>=0.27.0`, `alembic>=1.11.0`.
- **–ó–∞–¥–∞—á–∞ 0.2 –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –≤ `src/config/settings.py`**
    - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: `DB_TYPE`, `DB_USER`, `DB_PASSWORD`, `DB_HOST`, `DB_PORT`, `DB_NAME` —Å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
    - –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∞ —Å—Ç—Ä–æ–∫–∞ `DATABASE_URL` –¥–ª—è `postgresql+asyncpg`.
    - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ë–î.
    - –û–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏–º–µ—Ä `.env` —Ñ–∞–π–ª–∞.
- **–ó–∞–¥–∞—á–∞ 0.2 –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `src/core/database.py` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î**
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `engine` SQLAlchemy.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ–∞–±—Ä–∏–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π `AsyncSessionLocal`.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä `get_db_session` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º commit/rollback/close.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `init_db` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (–¥–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏).
    - –°–æ–∑–¥–∞–Ω `src/core/__init__.py`.
- **–ó–∞–¥–∞—á–∞ 0.2 –®–∞–≥ 5: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ `init_db` –≤ `src/main.py`**
    - `init_db()` —Ç–µ–ø–µ—Ä—å –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `main()` –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –±–æ—Ç–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü, –µ—Å–ª–∏ –æ–Ω–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.
    - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ —Å–ª—É—á–∞–π –ø—Ä–æ–±–ª–µ–º —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –ë–î.
- **–ó–∞–¥–∞—á–∞ 0.2 –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–µ–Ω Alembic –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏—è–º–∏**
    - –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `pip install -r requirements.txt` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –≤–∫–ª—é—á–∞—è `alembic`.
    - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω Alembic (`alembic init alembic`).
    - –ù–∞—Å—Ç—Ä–æ–µ–Ω `alembic.ini`: `sqlalchemy.url` —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –±—Ä–∞—Ç—å—Å—è –∏–∑ `env.py`.
    - –ù–∞—Å—Ç—Ä–æ–µ–Ω `alembic/env.py`:
        - –î–æ–±–∞–≤–ª–µ–Ω –ø—É—Ç—å –∫ `src` –≤ `sys.path`.
        - –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω `DATABASE_URL` –∏–∑ `src.config.settings` –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ `sqlalchemy.url`.
        - `target_metadata` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `Base.metadata` –∏–∑ `src.models`.
        - –§—É–Ω–∫—Ü–∏—è `run_migrations_online` –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –¥–≤–∏–∂–∫–æ–º SQLAlchemy.
    - –°–æ–∑–¥–∞–Ω–∞ –ø–µ—Ä–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è `alembic/versions/init_0001_create_guild_configs_table.py` –≤—Ä—É—á–Ω—É—é –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `guild_configs` –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ë–î –≤ —Å—Ä–µ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ò–Ω–¥–µ–∫—Å –¥–ª—è `id` —Å–¥–µ–ª–∞–Ω —É–Ω–∏–∫–∞–ª—å–Ω—ã–º.
- **–ó–∞–¥–∞—á–∞ 0.2 (DBMS Setup and Database Model Definition with Guild ID) –∑–∞–ø–∏—Å–∞–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –≤ `Done.txt`**.
- **–ó–∞–¥–∞—á–∞ 0.2 —É–¥–∞–ª–µ–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞ `Tasks.txt`**.
(–ó–¥–µ—Å—å –±—É–¥—É—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –¥–µ–π—Å—Ç–≤–∏—è)
- –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ (`src/bot`, `src/core`, `src/models`, `src/utils`, `src/config`, `tests/`) —Å –ø–æ–º–æ—â—å—é `mkdir`. (–ù–µ—É–¥–∞—á–Ω–æ, –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–µ —Å–æ–∑–¥–∞–ª–∏—Å—å).
- –ü—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã –Ω–∞–ø—Ä—è–º—É—é, —Ç–∞–∫ –∫–∞–∫ `create_file_with_block` –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.
- –°–æ–∑–¥–∞–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞:
    - `src/main.py`
    - `src/bot/core.py`
    - `src/bot/events.py`
    - `src/bot/commands.py`
    - `src/config/settings.py`
    - `requirements.txt`
    - `.gitignore`
    - `src/bot/__init__.py`
    - `src/config/__init__.py`
    - `src/__init__.py`
    - `tests/__init__.py`
- –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `src/core/`, `src/models/`, `src/utils/` –ø–æ–∫–∞ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ñ–∞–π–ª–æ–≤, –Ω–æ –ø—É—Ç–∏ –¥–ª—è –Ω–∏—Ö —Å—É—â–µ—Å—Ç–≤—É—é—Ç –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–æ–∑–¥–∞–Ω–∏—é `src/__init__.py` –∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤ –≤ `src/`. –û–Ω–∏ –±—É–¥—É—Ç –Ω–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ –º–µ—Ä–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–¥–∞—á.
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `BotCore` –≤ `src/bot/core.py`:
    - –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `__init__` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `command_prefix` –∏ `intents`.
    - –ú–µ—Ç–æ–¥ `setup_hook` –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π (–∫–æ–≥–æ–≤).
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–≥–æ–≤ `bot.events` –∏ `bot.commands` —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–æ–∫.
    - –ú–µ—Ç–æ–¥ `on_ready` –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –±–æ—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞—Ö.
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π Discord –≤ `src/bot/events.py` –≤ –≤–∏–¥–µ `EventCog`:
    - `on_ready`: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ.
    - `on_message`: –ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–∏–≥–Ω–æ—Ä —Å–∞–º–æ–≥–æ —Å–µ–±—è).
    - `on_guild_join`: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.
    - `on_guild_remove`: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ.
    - `on_command_error`: –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –∫–æ–º–∞–Ω–¥.
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/ping` (—Ç–µ–∫—Å—Ç–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞, –ø—Ä–µ—Ñ–∏–∫—Å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏) –≤ `src/bot/commands.py` –≤ –≤–∏–¥–µ `CommandCog`:
    - –ö–æ–º–∞–Ω–¥–∞ `ping_command` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–æ–π –±–æ—Ç–∞.
    - –í–∫–ª—é—á–∞–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–∑–æ–≤–∞ –∫–æ–º–∞–Ω–¥—ã.
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
    - –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `logging.basicConfig` –≤ `src/main.py`.
    - –§–æ—Ä–º–∞—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: `%(asctime)s:%(levelname)s:%(name)s: %(message)s`.
    - –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–ø–µ—Ä—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `LOG_LEVEL` –≤ `src/config/settings.py` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é INFO).
- –ó–∞–¥–∞—á–∞ 0.1 (Discord Bot Project Initialization and Basic Guild Integration) –∑–∞–ø–∏—Å–∞–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –≤ `Done.txt`.
- –ó–∞–¥–∞—á–∞ 0.1 —É–¥–∞–ª–µ–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞ `Tasks.txt`.
- **–°–µ—Å—Å–∏—è [–¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è]: –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã. –ê–Ω–∞–ª–∏–∑ `AGENTS.md` –∑–∞–≤–µ—Ä—à–µ–Ω. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º. –ó–∞–¥–∞—á–∏ –±—É–¥—É—Ç –±—Ä–∞—Ç—å—Å—è –∏–∑ `Tasks.txt`, –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å, –∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –æ—Ç–º–µ—á–∞—Ç—å—Å—è –≤ `Done.txt`.**
- **–ó–∞–¥–∞—á–∞ üé≤ 6.3.1 Dice Roller Module:**
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/core/dice_roller.py` —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `roll_dice(dice_string)`.
    - –§—É–Ω–∫—Ü–∏—è –ø–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞ "NdX[+/-M]" –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—É–º–º—É –∏ —Å–ø–∏—Å–æ–∫ –±—Ä–æ—Å–∫–æ–≤.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–ª—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Å—Ç—Ä–æ–∫–∏.
    - –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Å—Ç–µ–π (1000) –∏ –≥—Ä–∞–Ω–µ–π (1000).
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `tests/core/test_dice_roller.py` —Å unit-—Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è `roll_dice`.
    - –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –ø—Ä–æ—Å—Ç—ã–µ –±—Ä–æ—Å–∫–∏, –±—Ä–æ—Å–∫–∏ —Å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ, –Ω—É–ª–µ–≤—ã–µ), –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ—Å—Ç–∏, –Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–±–µ–ª–∞–º, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∏ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —á–∏—Å–ª–∞ –∫–æ—Å—Ç–µ–π/–≥—Ä–∞–Ω–µ–π.
    - **–ü—Ä–æ–±–ª–µ–º–∞:** –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–º–∏ –∏–º–ø–æ—Ä—Ç–∞–º–∏ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º `src/core/crud.py` –∏ –ø–∞–∫–µ—Ç–∞ `src/core/crud/`.
    - **–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–º–ø–æ—Ä—Ç–æ–≤:**
        - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω `src/core/crud.py` –≤ `src/core/crud_base_definitions.py`.
        - –û–±–Ω–æ–≤–ª–µ–Ω `src/core/__init__.py` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `crud_base_definitions` (–∏–º–ø–æ—Ä—Ç, `__all__`, –ª–æ–≥–≥–µ—Ä).
        - –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã `CRUDBase` –≤ `src/core/crud/crud_location.py`, `src/core/crud/crud_player.py`, –∏ `src/core/crud/crud_party.py` –Ω–∞ `from src.core.crud_base_definitions import CRUDBase`.
    - **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–µ—Å–æ—á–Ω–∏—Ü–µ–π:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏–º–ø–æ—Ä—Ç–æ–≤, –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (`run_in_bash_session`) –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É "Failed to compute affected file count and total size... All changes to the repo have been rolled back." –≠—Ç–æ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤ –∏ –∫–æ–¥–∞ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º —Ä–µ–∂–∏–º–µ. –ü–æ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–º –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
- **–ó–∞–¥–∞—á–∞ üé≤ 6.3.2 Check Resolver Module:**
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/core/check_resolver.py`.
    - –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã Pydantic –º–æ–¥–µ–ª–∏ `ModifierDetail`, `CheckOutcome`, `CheckResult` –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–∫–∏.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `resolve_check(db, guild_id, check_type, ...)`:
        - –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `db: AsyncSession`.
        - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –∏–∑ `RuleConfig` (–Ω–æ—Ç–∞—Ü–∏—è –∫–æ—Å—Ç–µ–π, –±–∞–∑–æ–≤—ã–π –∞—Ç—Ä–∏–±—É—Ç, –ø–æ—Ä–æ–≥–∏ –∫—Ä–∏—Ç. —É—Å–ø–µ—Ö–∞/–Ω–µ—É–¥–∞—á–∏) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `get_rule`.
        - –°–æ–∑–¥–∞–Ω–∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `_get_entity_attribute` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞ —Å—É—â–Ω–æ—Å—Ç–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è, —Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑–≤–∏—Ç–∏—è —Å–∏—Å—Ç–µ–º—ã "Effective Stats").
        - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–∞—Å—á–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑–æ–≤–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤/—à—Ç—Ä–∞—Ñ–æ–≤. –û—Ç–º–µ—á–µ–Ω—ã –º–µ—Å—Ç–∞ –¥–ª—è –±—É–¥—É—â–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –æ—Ç —É–º–µ–Ω–∏–π, —Å–Ω–∞—Ä—è–∂–µ–Ω–∏—è, —Å—Ç–∞—Ç—É—Å–æ–≤.
        - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `dice_roller.roll_dice()` –¥–ª—è –±—Ä–æ—Å–∫–∞ –∫–æ—Å—Ç–µ–π.
        - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ (—É—Å–ø–µ—Ö, –Ω–µ—É–¥–∞—á–∞, –∫—Ä–∏—Ç. —É—Å–ø–µ—Ö/–Ω–µ—É–¥–∞—á–∞) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å DC –∏ –ø–æ—Ä–æ–≥–æ–≤ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
        - –†–µ–∑—É–ª—å—Ç–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ–±—ä–µ–∫—Ç–µ `CheckResult`.
    - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –±–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–ø–æ–≤ —Å—É—â–Ω–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ —É—Å–ª–æ–≤–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –º–æ–¥–µ–ª—è–º–∏ –≤ `_get_entity_attribute`.
    - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `tests/core/test_check_resolver.py` —Å unit-—Ç–µ—Å—Ç–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–º–∏ –º–æ–∫–∏ –¥–ª—è `get_rule`, `_get_entity_attribute` –∏ `roll_dice`. –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (—É—Å–ø–µ—Ö/–Ω–µ—É–¥–∞—á–∞, –∫—Ä–∏—Ç—ã, –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã, –æ—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏).
    - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (docstrings, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏) –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `src/core/check_resolver.py`, –æ—Ç–º–µ—á–µ–Ω—ã TODO –¥–ª—è –±—É–¥—É—â–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π.
    - **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ò–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –ø–µ—Å–æ—á–Ω–∏—Ü–µ–π, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–∫-—Ç–µ—Å—Ç–æ–≤ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∏—Ö –∑–∞–ø—É—Å–∫–µ (–°–µ—Å—Å–∏—è [—Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è] - –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)**
    - **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∫-—Ç–µ—Å—Ç–æ–≤:**
        - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω `AGENTS.md` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ —Å Discord API –∏ –ë–î.
        - –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è (`discord.Interaction`, `discord.Message`, `discord.ext.commands.Context`, —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –ë–î).
        - –í—ã–±—Ä–∞–Ω –Ω–∞—á–∞–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è: –∫–æ–º–∞–Ω–¥–∞ `/start` –∏ —Ç–µ–∫—Å—Ç–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ `!ping`.
        - –°–æ—Å—Ç–∞–≤–ª–µ–Ω –ø–ª–∞–Ω –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é —Ñ–∞–π–ª–∞ —Å —Ç–µ—Å—Ç–∞–º–∏, —Ñ–∏–∫—Å—Ç—É—Ä –∏ –Ω–∞–ø–∏—Å–∞–Ω–∏—é —Å–∞–º–∏—Ö —Ç–µ—Å—Ç–æ–≤.
    - **–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–∫-—Ç–µ—Å—Ç–æ–≤:**
        - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `tests/bot/test_general_commands_mocked.py`.
        - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã pytest-—Ñ–∏–∫—Å—Ç—É—Ä—ã: `mock_bot`, `mock_interaction`, `mock_db_session`, `command_cog`, `mock_ctx`.
        - –ù–∞–ø–∏—Å–∞–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–º–∞–Ω–¥—ã `/start`:
            - `test_start_command_new_player`: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞.
            - `test_start_command_existing_player`: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞.
            - `test_start_command_no_starting_location`: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–ª—É—á–∞–π –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –ª–æ–∫–∞—Ü–∏–∏.
        - –ù–∞–ø–∏—Å–∞–Ω —Ç–µ—Å—Ç –¥–ª—è –∫–æ–º–∞–Ω–¥—ã `!ping`: `test_ping_command`.
        - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã `unittest.mock.patch` –∏ `AsyncMock/MagicMock` –¥–ª—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
    - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–æ–≤ (–ø–æ–≤—Ç–æ—Ä–Ω–æ):**
        - **–ü—Ä–æ–±–ª–µ–º–∞ 1: `UnicodeDecodeError` –ø—Ä–∏ —Å–±–æ—Ä–µ `test_results.txt`**.
            - –ü—Ä–∏—á–∏–Ω–∞: Pytest –ø—ã—Ç–∞–ª—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª `test_results.txt` (–≤–µ—Ä–æ—è—Ç–Ω–æ, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞) –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–µ.
            - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é: –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª `test_results.txt` –∏–ª–∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –µ–≥–æ —Å–æ–∑–¥–∞–Ω–∏–µ –≤ UTF-8. (–ü–æ–≤—Ç–æ—Ä–Ω–æ)
        - **–ü—Ä–æ–±–ª–µ–º–∞ 2: `ImportError: cannot import name 'DEFAULT_STARTING_LOCATION_STATIC_ID' from 'src.config.settings'`**.
            - –ü—Ä–∏—á–∏–Ω–∞: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç `DEFAULT_STARTING_LOCATION_STATIC_ID` –∏ `DEFAULT_PLAYER_START_PARAMS_JSON` –≤ —Ñ–∞–π–ª–µ `src/config/settings.py`, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±–æ–≤–∞–ª–∏—Å—å –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ñ–∞–π–ª–µ.
            - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç—Ç–∏—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏–π –≤ `src/config/settings.py`. (–ü–æ–≤—Ç–æ—Ä–Ω–æ)
    - **–ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (–ø–æ–≤—Ç–æ—Ä–Ω–æ):**
        - –ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç (`feat/add-mock-tests`): –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã—Ö –º–æ–∫-—Ç–µ—Å—Ç–æ–≤. (–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω —Ä–∞–Ω–µ–µ)
        - –í—Ç–æ—Ä–æ–π –∫–æ–º–º–∏—Ç (`fix/add-missing-settings-consts`): –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç –≤ `settings.py`. (–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω —Ä–∞–Ω–µ–µ)
        - *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –¥–ª—è –ª–æ–≥–∞: –¢–µ–∫—É—â–∏–π –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ AGENTS.md –∏ –∫–æ–º–º–∏—Ç —è–≤–ª—è–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ –ø—Ä–æ—Å—å–±–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.*
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ Pyright (–°–µ—Å—Å–∏—è [—Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è])**
    - **–ê–Ω–∞–ª–∏–∑ `pyright_summary.txt`**: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Ñ–∞–π–ª `pyright_summary.txt` –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ.
    - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–∞ `Player.status`**:
        - –í–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö (`src/bot/commands/turn_commands.py`, `src/core/turn_controller.py`, `src/core/action_processor.py`) –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ `player.status` –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ `player.current_status` –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ `Player`.
        - –í `src/models/enums.py` –≤ Enum `PlayerStatus` –¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `PROCESSING_ACTION = "processing_action"`, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –≤ `src/bot/events.py`.
    - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ —Ç–∏–ø–∞ `None` –¥–ª—è `guild_id`**:
        - –í —Ñ–∞–π–ª–µ `src/bot/commands/turn_commands.py` –¥–ª—è –∫–æ–º–∞–Ω–¥, –¥–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö `@app_commands.guild_only()`, –¥–æ–±–∞–≤–ª–µ–Ω—ã —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è `assert interaction.guild_id is not None` –∏ —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —Ç–∏–ø–∞ `guild_id: int = interaction.guild_id`. –≠—Ç–æ —Ä–µ—à–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã `int | None` –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ `guild_id` –≤ —Ñ—É–Ω–∫—Ü–∏–∏, –æ–∂–∏–¥–∞—é—â–∏–µ `int`.
    - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–∏–ø–∞ `session_maker`**:
        - –í `src/core/turn_controller.py` —Ñ—É–Ω–∫—Ü–∏—è `trigger_guild_turn_processing` –æ–∂–∏–¥–∞–ª–∞ `session_maker: Callable[[], AsyncSession]`.
        - –ü–µ—Ä–µ–¥–∞–≤–∞–µ–º–∞—è `get_db_session` –∏–∑ `src/core/database.py` –∏–º–µ–µ—Ç —Ç–∏–ø `Callable[[], AsyncContextManager[AsyncSession]]`.
        - –¢–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `session_maker` –≤ `trigger_guild_turn_processing` –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `Callable[[], AsyncContextManager[AsyncSession]]` –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω `AsyncContextManager` –∏–∑ `typing`.
    - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ "Object of type 'None' cannot be used as iterable value"**:
        - –í —Ñ–∞–π–ª–∞—Ö `src/bot/commands/turn_commands.py`, `src/core/turn_controller.py`, `src/core/action_processor.py` —Ü–∏–∫–ª—ã, –∏—Ç–µ—Ä–∏—Ä—É—é—â–∏–µ –ø–æ `party.player_ids_json` (–∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å `None`), –∏–∑–º–µ–Ω–µ–Ω—ã –Ω–∞ `for item in (party.player_ids_json or []):` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.
    - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–∏–ø–∞ –≤ `process_actions_for_guild`**:
        - –í `src/core/turn_controller.py` —Ñ—É–Ω–∫—Ü–∏—è `_start_action_processing_worker` –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∞ `list[dict]` –≤ `process_actions_for_guild`, –Ω–æ –µ–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `entities_to_process` –±—ã–ª –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ `list[tuple[int, str]]`.
        - –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è —Ç–∏–ø–∞ –¥–ª—è `entities_to_process` –≤ `_start_action_processing_worker` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ `list[dict[str, Any]]`. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω `Any` –∏–∑ `typing`.
    - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ `tests/test_main.py`**:
        - –û—à–∏–±–∫–∏ –≤–∏–¥–∞ `Cannot access attribute "called" / "call_args" for class "type[BotCore]"` –≤–æ–∑–Ω–∏–∫–∞–ª–∏ –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ Pyright –Ω–µ –º–æ–≥ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ `BotCore` –±—ã–ª –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ `MagicMock` –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤.
        - –ö —Å—Ç—Ä–æ–∫–∞–º —Å –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏ `.called` –∏ `.call_args` –∫ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É `BotCore` –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ `# type: ignore`.
    - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤**:
        - `src/bot/commands/master_ai_commands.py`: –ü—Ä–∏ –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ `save_approved_generation` (–¥–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π `@transactional`) –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –∞—Ä–≥—É–º–µ–Ω—Ç `session`. Pyright –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª, —á—Ç–æ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –≤–Ω–µ–¥—Ä—è–µ—Ç —Å–µ—Å—Å–∏—é. –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π `# type: ignore` –∫ –≤—ã–∑–æ–≤—É.
        - `src/bot/events.py`: –û—à–∏–±–∫–∞ "Argument missing for parameter 'message'" –Ω–∞ —Å—Ç—Ä–æ–∫–µ 123 –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–º –≤—ã–∑–æ–≤–æ–º –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ —Ñ–∞–π–ª–∞. –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ –ª–∏–±–æ —É—Å—Ç–∞—Ä–µ–≤—à–∞—è –æ—à–∏–±–∫–∞, –ª–∏–±–æ –Ω–µ–≤–µ—Ä–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã Pyright, —Ç–∞–∫ –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –≤—ã–∑–æ–≤ (`process_player_message_for_nlu`) –≤—ã–≥–ª—è–¥–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Å —É—á–µ—Ç–æ–º —Ä–∞–±–æ—Ç—ã –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ `@transactional`.

## –¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω

**(–ó–∞–¥–∞—á–∞ ‚öôÔ∏è 6.11 –ó–∞–≤–µ—Ä—à–µ–Ω–∞.)**

---
**–ó–∞–¥–∞—á–∞: ‚öôÔ∏è 6.1.1 Intra-Location Interaction Handler Module (–ó–∞–≤–µ—Ä—à–µ–Ω–æ)**

1.  **Analyze Requirements for ‚öôÔ∏è 6.1.1 Intra-Location Interaction Handler Module.** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    *   Reviewed task description: Handles actions within the current location (move_to_sublocation, interact_with_object, examine_object).
    *   API: `handle_intra_location_action(guild_id: int, session: Session, player_id: int, action_data: dict) -> dict`.
    *   Dependencies confirmed.
2.  **Define/Update Player Model for "Position Within Location".** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    *   Added `Player.current_sublocation_name: Optional[str]`.
    *   Created Alembic migration `0008_add_player_sublocation.py` (down_revision `4a069d44a15c` after user clarification on migration history reset).
3.  **Implement `handle_intra_location_action` in `src/core/interaction_handlers.py`.** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    *   Created the function with logic for `examine`, `interact` (MVP with placeholders for full rule/check/consequence logic), and `move_to_sublocation`.
    *   Assumes interactables are defined in `Location.generated_details_json.interactable_elements`.
    *   Added to `src/core/__init__.py`.
4.  **Integrate `handle_intra_location_action` with Central Action Processor (Task 6.11).** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    *   Updated `ACTION_DISPATCHER` in `src/core/action_processor.py` for new intents (`examine`, `interact`, `go_to`).
    *   Added wrapper function `_handle_intra_location_action_wrapper`.
5.  **Update NLU (Task 6.10 - `src/core/nlu_service.py`) if necessary.** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    *   Modified "examine" pattern and added new patterns for "interact" and "go_to" (for sublocations).
6.  **Testing (Conceptual/Manual).** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    *   Defined test cases and expected outcomes.
    *   Identified and implemented a refinement for `player.current_sublocation_name` setting.
7.  **Documentation.** (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)
    *   `AGENTS.md` updated. Task completion will be recorded in `Done.txt` and `Tasks.txt`.

**(–ó–∞–¥–∞—á–∞ ‚öôÔ∏è 6.1.1 –ó–∞–≤–µ—Ä—à–µ–Ω–∞.)**

---
**(–û–∂–∏–¥–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–∏)**
